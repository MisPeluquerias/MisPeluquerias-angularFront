<div class="modal-header">
  <h4 class="modal-title">Regístrate</h4>
  <button
    type="button"
    aria-label="Close"
    class="btn-close me-2"
    (click)="activeModal.dismiss('Cross click')"
  ></button>
</div>
<div class="modal-body text-center px-5">
  <div class="text-center mb-3">
    <img
      src="../../../assets/img/web/sello.jpg"
      width="120"
      alt="logo-mis-peluquerias"
    />
  </div>
  <form class="w-100" [formGroup]="registerForm" (ngSubmit)="onSubmit()">
    <div class="row mb-3">
      <div class="col-md-6">
        <label for="name" class="form-label fw-bold">Nombre</label>
        <input
          type="text"
          class="form-control text-center"
          id="name"
          placeholder="Nombre"
          formControlName="name"
        />
        <div *ngIf="registerForm.get('name')?.invalid && (registerForm.get('name')?.dirty || registerForm.get('name')?.touched)" class="text-danger">
          <small *ngIf="registerForm.get('name')?.errors?.['required']">El nombre es obligatorio.</small>
        </div>
      </div>
      <div class="col-md-6">
        <label for="lastname" class="form-label fw-bold">Apellidos</label>
        <input
          type="text"
          class="form-control text-center"
          id="lastname"
          placeholder="Apellidos"
          formControlName="lastname"
        />
        <div *ngIf="registerForm.get('lastname')?.invalid && (registerForm.get('lastname')?.dirty || registerForm.get('lastname')?.touched)" class="text-danger">
          <small *ngIf="registerForm.get('lastname')?.errors?.['required']">Los apellidos son obligatorios.</small>
        </div>
      </div>
    </div>
    <div class="row mb-3 py-3">
      <div class="col-md-6">
        <label for="birth_date" class="form-label fw-bold">Fecha de nacimiento</label>
        <input
          type="date"
          class="form-control text-center"
          id="birth_date"
          formControlName="birth_date"
        />
        <div *ngIf="registerForm.get('birth_date')?.invalid && (registerForm.get('birth_date')?.dirty || registerForm.get('birth_date')?.touched)" class="text-danger">
          <small *ngIf="registerForm.get('birth_date')?.errors?.['required']">La fecha de nacimiento es obligatoria.</small>
        </div>
      </div>
      <div class="col-md-6">
        <label for="phone" class="form-label fw-bold">Teléfono</label>
        <input
          type="tel"
          class="form-control text-center"
          id="phone"
          placeholder="Teléfono"
          formControlName="phone"
        />
        <div *ngIf="registerForm.get('phone')?.invalid && (registerForm.get('phone')?.dirty || registerForm.get('phone')?.touched)" class="text-danger">
          <small *ngIf="registerForm.get('phone')?.errors?.['pattern']">Debe ser un número de teléfono válido (9 dígitos).</small>
        </div>
      </div>
    </div>
    <div class="row">
      <!-- Select de Provincia -->
      <div class="col-md-6 form-group py-3">
        <label for="province" class="form-label">Provincia</label>
        <select
          class="form-select"
          id="id_province"
          formControlName="id_province"
          (change)="onProvinceChange($any($event.target).value)"
          required
        >
          <option value="">Seleccione una provincia...</option>
          <option
            *ngFor="let province of provinces"
            [value]="province.id_province"
          >
            {{ province.name }}
          </option>
        </select>
      </div>


      <!-- Select de Ciudad -->
      <div class="col-md-6 form-group py-3">
        <label for="city" class="form-label">Ciudad-CP</label>
        <select
          class="form-select"
          id="id_city"
          formControlName="id_city"
          required
        >
          <option value="">Seleccione una ciudad...</option>
          <option *ngFor="let city of cities" [value]="city.id_city">
            {{ city.city_name }} - {{ city.zip_code }}
          </option>
        </select>
      </div>
      </div>

      <div class="row mb-3 py-3">
        <div class="col-md-6 offset-md-3 d-flex justify-content-center">
          <div class="w-100">
            <label for="dni" class="form-label fw-bold text-center">DNI</label>
            <input
              type="text"
              class="form-control text-center"
              id="dni"
              placeholder="DNI"
              formControlName="dni"
            />
            <div
              *ngIf="registerForm.get('dni')?.invalid && (registerForm.get('dni')?.dirty || registerForm.get('dni')?.touched)"
              class="text-danger text-center"
            >
              <small *ngIf="registerForm.get('dni')?.errors?.['required']">El DNI es obligatorio.</small>
              <small *ngIf="registerForm.get('dni')?.errors?.['pattern']">El DNI no es válido.</small>
            </div>
          </div>
        </div>
      </div>

    <div class="row mb-3 mt-3 py-3">
      <div class="col-md-6">
        <label for="email" class="form-label fw-bold">Correo electrónico</label>
        <input
          type="email"
          class="form-control text-center"
          id="email"
          placeholder="Correo electrónico"
          formControlName="email"
        />
        <div *ngIf="registerForm.get('email')?.invalid && (registerForm.get('email')?.dirty || registerForm.get('email')?.touched)" class="text-danger">
          <small *ngIf="registerForm.get('email')?.errors?.['required']">El correo electrónico es obligatorio.</small>
          <small *ngIf="registerForm.get('email')?.errors?.['email']">Debe ser un correo electrónico válido.</small>
        </div>
      </div>

    <div class="mb-3 col-md-6">
      <label for="address" class="form-label fw-bold">Dirección</label>
      <input
        type="text"
        class="form-control text-center"
        id="address"
        placeholder="Dirección"
        formControlName="address"
      />
    </div>
    </div>
    <div class="row mb-3">
      <div class="col-md-6">
        <label for="password" class="form-label fw-bold">Contraseña</label>
        <input
          type="password"
          class="form-control text-center"
          id="password"
          placeholder="Contraseña"
          formControlName="password"
        />
        <div *ngIf="registerForm.get('password')?.invalid && (registerForm.get('password')?.dirty || registerForm.get('password')?.touched)" class="text-danger">
          <small *ngIf="registerForm.get('password')?.errors?.['required']">La contraseña es obligatoria.</small>
          <small *ngIf="registerForm.get('password')?.errors?.['minlength']">La contraseña debe tener al menos 6 caracteres.</small>
        </div>
      </div>
      <div class="col-md-6">
        <label for="confirmPassword" class="form-label fw-bold">Confirmar contraseña</label>
        <input
          type="password"
          class="form-control text-center"
          id="confirmPassword"
          placeholder="Confirmar contraseña"
          formControlName="confirmPassword"
        />
        <div *ngIf="registerForm.hasError('mismatch') && (registerForm.get('confirmPassword')?.dirty || registerForm.get('confirmPassword')?.touched)" class="text-danger">
          <small>Las contraseñas no coinciden.</small>
        </div>
      </div>
    </div>
    <div class="text-center">
      <button
        type="submit"
        class="btn btn-danger rounded-pill px-4 mb-4"
        [disabled]="!registerForm.valid"
      >
        Registrar Usuario
      </button>
    </div>
    <small id="error" class="text-danger mb-4">{{ errorMessage }}</small>
    <small id="success" class="text-success mb-4">{{ successMessage }}</small>
    <div class="row mt-3">
      <small
        >Si ya posees una cuenta puedes ir a
        <a href="" (click)="openLoginModal($event)"
          >ingreso de usuarios</a
        ></small
      >
    </div>
  </form>
</div>
